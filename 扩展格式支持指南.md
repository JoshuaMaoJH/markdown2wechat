# 📄 扩展格式支持指南

## 🎯 概述

原始的 **Markdown2WeChat** 项目专门针对 Markdown 格式设计，但通过扩展可以实现对其他格式的支持。本文档详细说明了如何扩展支持其他文件格式。

## ✅ 当前支持格式

### 1. **Markdown (.md, .markdown)** - 完全支持
- **状态**: ✅ 原生支持
- **功能**: 完整支持所有 Markdown 语法
- **依赖**: 无需额外依赖
- **示例**: `python markdown2wechat.py article.md`

### 2. **HTML (.html, .htm)** - 完全支持
- **状态**: ✅ 扩展支持
- **功能**: 直接优化现有HTML，保持结构
- **依赖**: 无需额外依赖
- **示例**: `python extended_converter.py article.html`

## 🔧 可扩展格式

### 3. **纯文本 (.txt)** - 基础支持
- **状态**: ⚠️ 扩展支持
- **功能**: 基本格式转换，支持简单标题和列表
- **依赖**: 无需额外依赖
- **限制**: 格式识别有限
- **示例**: `python extended_converter.py article.txt`

### 4. **RST (.rst)** - 需要依赖
- **状态**: ⚠️ 需要安装依赖
- **功能**: 完整RST语法支持
- **依赖**: `pip install docutils`
- **示例**: `python extended_converter.py article.rst`

### 5. **Word文档 (.docx)** - 需要依赖
- **状态**: ⚠️ 需要安装依赖
- **功能**: 提取文本和基本格式
- **依赖**: `pip install python-docx`
- **限制**: 复杂格式可能丢失
- **示例**: `python extended_converter.py article.docx`

### 6. **RTF (.rtf)** - 需要依赖
- **状态**: ⚠️ 需要安装依赖
- **功能**: 转换为纯文本后处理
- **依赖**: `pip install striprtf`
- **限制**: 格式信息丢失
- **示例**: `python extended_converter.py article.rtf`

## ❌ 不支持格式

### 7. **PDF (.pdf)** - 不支持
- **原因**: 需要OCR或特殊解析
- **替代方案**: 先转换为Word或纯文本

### 8. **图片格式** - 不支持
- **原因**: 需要OCR识别文字
- **替代方案**: 使用OCR工具提取文字

## 🚀 使用方法

### 安装扩展依赖
```bash
# 安装所有扩展依赖
pip install -r requirements_extended.txt

# 或者选择性安装
pip install docutils          # RST支持
pip install python-docx       # Word支持
pip install striprtf          # RTF支持
```

### 使用扩展转换器
```bash
# 查看支持的格式
python extended_converter.py --list-formats

# 转换不同格式的文件
python extended_converter.py article.html --style tech
python extended_converter.py document.docx -t "文章标题"
python extended_converter.py notes.txt -o output.html
```

### Python API使用
```python
from extended_converter import ExtendedMarkdownToWeChatConverter

# 创建转换器
converter = ExtendedMarkdownToWeChatConverter(style="tech")

# 转换不同格式
converter.convert_file('article.html', 'output.html')
converter.convert_file('document.docx', 'output.html')
converter.convert_file('notes.txt', 'output.html')
```

## 📊 格式对比

| 格式 | 支持程度 | 格式保持 | 安装难度 | 推荐度 |
|------|----------|----------|----------|--------|
| Markdown | ⭐⭐⭐⭐⭐ | 完美 | 简单 | ⭐⭐⭐⭐⭐ |
| HTML | ⭐⭐⭐⭐⭐ | 完美 | 简单 | ⭐⭐⭐⭐⭐ |
| 纯文本 | ⭐⭐⭐ | 基础 | 简单 | ⭐⭐⭐ |
| RST | ⭐⭐⭐⭐ | 良好 | 中等 | ⭐⭐⭐⭐ |
| Word | ⭐⭐⭐ | 中等 | 中等 | ⭐⭐⭐ |
| RTF | ⭐⭐ | 基础 | 中等 | ⭐⭐ |

## 💡 使用建议

### 最佳实践
1. **优先使用Markdown**: 格式最完整，支持最好
2. **HTML作为备选**: 如果已有HTML内容，可以直接使用
3. **纯文本简单内容**: 适合简单的文章内容
4. **RST技术文档**: 适合技术文档和结构化内容

### 格式选择指南
- **技术博客** → Markdown 或 RST
- **现有网页** → HTML
- **简单文章** → 纯文本
- **办公文档** → Word (需要转换)
- **复杂格式** → 建议先转换为Markdown

## 🔧 技术实现

### 核心转换流程
1. **格式检测**: 根据文件扩展名识别格式
2. **内容读取**: 使用相应库读取文件内容
3. **格式转换**: 将内容转换为HTML
4. **样式优化**: 应用微信公众号样式
5. **输出生成**: 生成最终HTML文件

### 扩展原理
```python
def convert_content(self, content, file_format, file_path=None):
    """根据格式转换内容"""
    if file_format == 'markdown':
        return self.convert_markdown(content)
    elif file_format == 'html':
        return self.convert_html(content)
    elif file_format == 'text':
        return self.convert_text(content)
    # ... 其他格式
```

## 🎯 总结

虽然原始的 **Markdown2WeChat** 项目专门针对 Markdown 设计，但通过扩展可以支持多种格式：

- ✅ **Markdown**: 完全支持，推荐使用
- ✅ **HTML**: 完全支持，适合现有网页
- ⚠️ **其他格式**: 需要额外依赖，功能有限

**建议**: 如果可能，优先将其他格式的内容转换为 Markdown，这样可以获得最佳的转换效果和完整的格式支持。

---

**🎨 让您的各种格式文档都能转换为美观的微信公众号文章！** ✨
