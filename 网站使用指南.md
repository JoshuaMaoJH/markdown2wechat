# 🌐 Markdown2WeChat 独立网站使用指南

## 🎯 项目简介

这是一个基于Flask的独立网站，为用户提供Markdown到微信公众号文章的在线转换服务。网站支持多种文件格式，提供8种精美的排版风格，具有现代化的用户界面和强大的功能。

## ✨ 主要功能

### 🎨 **多格式支持**
- **Markdown** (.md, .markdown) - 原生支持
- **HTML** (.html, .htm) - 转换为Markdown后处理
- **纯文本** (.txt) - 智能格式识别
- **RST** (.rst) - 需要docutils依赖
- **Word** (.docx) - 需要python-docx依赖
- **RTF** (.rtf) - 需要striprtf依赖

### 🎨 **8种预设风格**
- **默认风格** - 简洁专业，蓝色主题
- **科技风格** - 现代简约，深色主题
- **金融风格** - 稳重专业，金色主题
- **网红风格** - 活泼时尚，粉色主题
- **极简风格** - 黑白灰，简洁优雅
- **彩色风格** - 彩虹主题，活泼有趣
- **暗黑风格** - 深色主题，护眼舒适
- **优雅风格** - 古典雅致，深蓝主题

### 🔄 **转换功能**
- **拖拽上传** - 支持拖拽文件到上传区域
- **实时预览** - 转换完成后立即显示效果
- **一键复制** - 复制HTML代码到剪贴板
- **文件下载** - 下载转换后的HTML文件
- **新窗口预览** - 在新窗口中预览完整效果

## 🚀 快速开始

### 方法一：直接运行（推荐）

```bash
# 1. 进入网站目录
cd website

# 2. 运行启动脚本
chmod +x start.sh
./start.sh
```

### 方法二：手动安装

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 创建必要目录
mkdir -p uploads outputs logs

# 3. 启动服务
python app.py
```

### 方法三：Docker部署

```bash
# 1. 构建镜像
docker build -t markdown2wechat .

# 2. 运行容器
docker run -p 5000:5000 markdown2wechat

# 或使用docker-compose
docker-compose up -d
```

## 🌐 访问网站

启动成功后，在浏览器中访问：

- **主页**: http://localhost:5000
- **API健康检查**: http://localhost:5000/api/health
- **API文档**: http://localhost:5000/api/styles

## 📱 使用步骤

### 1. 上传文件
- 点击上传区域选择文件
- 或直接拖拽文件到上传区域
- 支持的文件格式会自动验证

### 2. 配置选项
- **文章标题**: 输入文章标题
- **副标题**: 输入副标题（可选）
- **选择风格**: 点击选择喜欢的排版风格

### 3. 开始转换
- 点击"开始转换"按钮
- 等待转换完成（通常几秒钟）
- 查看转换进度和状态

### 4. 预览和下载
- **实时预览**: 在右侧预览区域查看效果
- **复制HTML**: 点击"复制HTML"按钮复制代码
- **下载文件**: 点击"下载文件"按钮保存HTML文件
- **新窗口预览**: 点击"新窗口预览"在新标签页查看

## 🔧 API接口

### 核心接口

```bash
# 文件转换
POST /api/convert
Content-Type: multipart/form-data
参数: file, title, subtitle, style

# 文件下载
GET /api/download/<conversion_id>

# 文件预览
GET /api/preview/<conversion_id>

# 获取风格列表
GET /api/styles

# 获取支持格式
GET /api/formats

# 健康检查
GET /api/health
```

### 使用示例

```bash
# 转换文件
curl -X POST -F "file=@article.md" -F "title=我的文章" -F "style=tech" http://localhost:5000/api/convert

# 获取风格列表
curl http://localhost:5000/api/styles

# 健康检查
curl http://localhost:5000/api/health
```

## ⚙️ 配置选项

### 环境变量

```bash
# 应用配置
FLASK_APP=app.py
FLASK_ENV=production
SECRET_KEY=your-secret-key

# 文件配置
MAX_CONTENT_LENGTH=16777216  # 16MB
UPLOAD_FOLDER=uploads
OUTPUT_FOLDER=outputs

# 清理配置
CLEANUP_INTERVAL=3600  # 1小时
FILE_RETENTION_HOURS=24  # 24小时
```

### 修改配置

1. **文件大小限制**: 修改`MAX_CONTENT_LENGTH`
2. **存储路径**: 修改`UPLOAD_FOLDER`和`OUTPUT_FOLDER`
3. **清理间隔**: 修改`CLEANUP_INTERVAL`
4. **文件保留时间**: 修改`FILE_RETENTION_HOURS`

## 🛠️ 开发指南

### 项目结构

```
website/
├── app.py                 # Flask应用主文件
├── index.html             # 前端页面
├── requirements.txt       # Python依赖
├── Dockerfile            # Docker配置
├── docker-compose.yml    # Docker Compose配置
├── start.sh              # 启动脚本
├── config.env            # 环境变量配置
├── uploads/              # 上传文件目录
├── outputs/              # 输出文件目录
└── logs/                 # 日志文件目录
```

### 添加新功能

1. **添加新风格**:
   - 在`wechat_styles.py`中添加新风格
   - 更新前端风格选择器

2. **添加新格式**:
   - 在`universal_converter.py`中添加转换函数
   - 更新`ALLOWED_EXTENSIONS`列表

3. **添加新API**:
   - 在`app.py`中添加新的路由函数
   - 更新前端API调用

### 调试模式

```bash
# 启用调试模式
export FLASK_ENV=development
export FLASK_DEBUG=1
python app.py
```

## 🚀 部署到生产环境

### 使用Gunicorn

```bash
# 安装Gunicorn
pip install gunicorn

# 启动生产服务器
gunicorn --bind 0.0.0.0:5000 --workers 4 --timeout 30 app:app
```

### 使用Nginx反向代理

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 使用Docker部署

```bash
# 构建镜像
docker build -t markdown2wechat .

# 运行容器
docker run -d -p 5000:5000 --name markdown2wechat markdown2wechat

# 使用docker-compose
docker-compose up -d
```

## 🔒 安全注意事项

### 文件安全
- 严格验证文件类型和大小
- 定期清理临时文件
- 限制上传频率

### 服务器安全
- 使用HTTPS加密传输
- 设置防火墙规则
- 定期更新依赖包

### 数据安全
- 不存储用户敏感信息
- 定期清理转换记录
- 使用安全的随机密钥

## 📊 性能优化

### 服务器优化
- 使用Gunicorn多进程
- 配置Nginx缓存
- 启用gzip压缩

### 应用优化
- 异步文件处理
- Redis缓存结果
- 数据库连接池

### 前端优化
- 压缩静态资源
- 使用CDN加速
- 懒加载图片

## 🐛 常见问题

### Q: 文件上传失败？
A: 检查文件大小是否超过16MB，文件格式是否支持

### Q: 转换速度慢？
A: 大文件转换需要时间，可以尝试压缩文件或分段处理

### Q: 样式显示异常？
A: 检查浏览器兼容性，建议使用现代浏览器

### Q: API调用失败？
A: 检查请求格式和参数，查看服务器日志

## 📞 技术支持

### 获取帮助
- 查看API文档: `/api/health`
- 检查服务器日志: `logs/app.log`
- 测试API接口: `/api/styles`

### 报告问题
- 提供详细的错误信息
- 包含复现步骤
- 附上相关日志文件

## 🎉 总结

Markdown2WeChat独立网站提供了完整的在线转换服务，具有：

- ✅ **现代化界面** - 美观易用的用户界面
- ✅ **多格式支持** - 支持6种文件格式
- ✅ **8种风格** - 丰富的排版选择
- ✅ **实时预览** - 即时查看转换效果
- ✅ **API服务** - 完整的RESTful API
- ✅ **易于部署** - 支持多种部署方式

通过这个网站，用户可以轻松地将各种格式的文档转换为美观的微信公众号文章，大大提高了内容创作的效率！

---

**🌐 开始您的Markdown2WeChat网站之旅吧！** ✨
